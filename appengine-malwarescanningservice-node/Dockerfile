FROM node:14-slim

ENV UNSCANNED_BUCKET=unscanned-docs-poc \
    CLEAN_BUCKET=scanned-docs-poc\
    QUARANTINED_BUCKET=quarantined-docs-poc

COPY . /app

WORKDIR /app

RUN ls -la

RUN npm install 

RUN apt-get update

RUN apt-get install -y \
    clamav \
    clamav-daemon

RUN freshclam 

RUN  echo "TCPSocket 3310" >> /etc/clamav/clamd.conf && \
    echo "TCPAddr 127.0.0.1" >> /etc/clamav/clamd.conf

RUN mkdir /unscanned_files

CMD ["sh", "bootstrap.sh"]
